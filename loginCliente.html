<!DOCTYPE html>
<html lang="pt-l,.br">

<head>

    <title>Easy Park - Login Cliente</title>

    <!-- Meta tags Obrigatórias -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/loginCliente.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <link rel="shortcut icon" href="/img/logo_ep_icon (1).ico">

    <!---Icone Search--->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <!---Arhivo Black 400--->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&display=swap" rel="stylesheet">


    <!---Abel 400--->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Abel&family=Archivo+Black&display=swap" rel="stylesheet">

</head>

<header>

    <!---================================================== Barra de navegação =================================================================================--->

    <div class="containerX">
        <div class="navbar">
            <nav>
                <div class="botoes">
                    <div><a href="index.html" class="logo"><img src="/img/logo_ep.png" alt="Logo EasyPark"></a></div>
                    <a href="loginCliente.html" class="btn_nav">Login / Crie sua Conta</a>
                    <a href="index.html#contato" class="btn_nav">Contato</a>
                    <a href="index.html#sobrenos" class="btn_nav">Sobre nós</a>
                    <a href="chose.html" class="btn_nav">Reserva</a>
                    <form class="pesquisa">
                        <a href="#" class="user_btn"><span class="material-symbols-outlined">account_circle</span></a>
                        <div>
                            <input type="search" id="pesquisa" placeholder="Pesquisar...">
                        </div>
                        <a href="#" class=search_btn><span class="material-symbols-outlined"> search </span> </a>
                    </form>
                </div>
            </nav>
        </div>
    </div>
</header>



<body>
    
        <div class="background">

            <!---================================================== Pop - Cadastro =================================================================================--->

            <div class="popup1">

                <div class="popup2">

                    <div class="containerY">
                        
                        // Formulário
                        <form id="cadlog-btn">

                            <h1 id="demo1">VARIAVEL 1</h1>
                            <h1 id="demo2">VARIAVEL 2</h1>

                            <div id="sucessoLogin">

                            <div class="imgcontainer">
                                <h1>Faça seu Login!</h1>
                            </div>

                            <div class="container-Popup">
                                <label for="email"><b>E-mail</b></label>
                                <input type="email" id="email" placeholder="E-mail" name="email" required>

                                <label for="senha"><b>Senha</b></label>
                                <input type="senha" id="senha" placeholder="Senha" name="senha" required>

                                <button type="submit">Login</button>
                                <label>
                                    <input type="checkbox" name="remember"> Lembre-me
                                </label>
                            </div>

                            <div class="container-Popup" style="background-color:#f1f1f1">
                                <span class="psw">Esqueceu a senha? Clique <a href="#">aqui</a></span>
                                <a href="/cadastroCliente.html"><button type="button"
                                        class="cancelbtn">Cadastre-se</button></a>
                            </div>
                            </div>
                        </form>

                        // Botões de Teste
                        <div></div>
                        <div></div>
                        <div></div>
                        <button id="novoConfirmaLogin" onclick="confirmaLogin()">Confirma Login</button>
                        <button id="botaoTeste" onclick="botaoTeste()">Teste</button>
                        <button id="botaoTeste2" onclick="botaoTeste2()">Teste Cookies</button>

                    </div>

                </div>

            </div>

        </div>


    <!---================================================== Scripts =================================================================================--->

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>

    <script>

        // Confirma o Login
        function confirmaLogin() {

            // Banco de Dados
            var nameDB;
            var emailDB;
            var senhaDB;

            // Formulario de Login
            const login = document.getElementById("email").value;
            const password = document.getElementById("senha").value;

            getUserData(login);

            // Verifica se as Variaveis do Login estão corretas
            if (password == senhaDB || login == emailDB) {
                
                alert("Login com Sucesso");
                
                // Troca o Formulário por Texto
                const loginSucesso = "<h1> Login feito</h1> <h1> com Sucesso!</h1>";
                document.getElementById("sucessoLogin").innerHTML = loginSucesso;

                document.cookie = "name=" + emailDB + "; path=/, "email=" + emailDB + "; path=/,";

                document.location.href = index.html;
            
            } else {
                
                alert("Erro ao Cadastrar");
                
            }
        }

        
        // Busca dados no Banco e Retorna elas em formato de variaveis
        async function getUserData() {
            // Envia o GET Request
            const response = await fetch(`http://localhost:8080/cliente/list/${login}`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                },
            })
                // Transforma a resposta em JSON
                .then((response) => {
                    return response.json();
                })
                
                // Busca data dentro do JSON e aloca em variaveis
                .then((data) => {
                    // Testar sem a linha baixo
                    let testeData = data;

                    // Console Logs
                    console.log(testData.name);
                    console.log(testData.email);
                    console.log(testData.senha);
                    
                    // Converte as Variaveis
                    emailDB = testeData.email;
                    emailDB = testeData.email;
                    senhaDB = testeData.senha;
                    
                });
        }


        
         // Botão Teste
        function botaoTeste() {

            email = document.getElementById("email").value;
            senha = document.getElementById("senha").value;

            teste12 = getUserData2(email);

            document.getElementById("demo1").innerHTML = teste123.name;
            document.getElementById("demo2").innerHTML = teste123.senha;

        }

        
        // Busca dados no Banco e Retorna elas em formato de variaveis
        async function getUserData2(teste2) {
            // Envia o GET Request
            const response = await fetch(`http://localhost:8080/cliente/list/${login}`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                },
            })
                // Transforma a resposta em JSON
                .then((response) => {
                    return response.json();
                })
                // Busca data dentro do JSON e aloca em variaveis
                .then((data) => {
                    // Testar sem a linha baixo
                    let testeData = data;
                    teste2 = testeData.name;
                    
                });
        }




function botaoTeste2() {

            document.getElementById("demo1").innerHTML = document.cookie;
     
}

        
        // Teste Lembrar Login
        function rememberLogin() {

            var login = document.getElementById("login").value;
            var password = document.getElementById("password").value;

            localStorage.setItem("rememberLogin", login);
            localStorage.setItem("passwordLogin", password);

        }


    </script>

</body>

</html>
